<?xml version="1.0"?>
<testCase version="8.4.0.202012071239">
    <general>
        <language>Python</language>
    </general>
    <execution renderCommentsIntoIssues="true"/>
    <testbed>project://a_voip/topologies/VeloCloud/VC840/VC840_lab_basic_adtran.tbml</testbed>
    <procedures>
        <item name="main">
            <steps>
                <item guid="d9e04343-b0cd-41bc-a46a-4cf9abc7584b" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Opening devices...</body>
                    </command>
                    <nestedSteps>
                        <item guid="a06a53e9-0764-4af6-9903-e929683c48f8" action="open" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>device:SD-WAN#python</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionProperties type="com.fnfr.svt.applications.python.PythonSessionProperties"/>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                        <item guid="1050e52d-8893-497a-8c12-e417ff179fa9" action="open" session="IXIA_SWITCH">
                            <command>
                                <body>device:Switch#ssh</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                <sessionProperties type="com.fnfr.svt.applications.ssh.documents.SSHProperties"/>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="43a2456f-0151-4b8c-a2e4-71466831ebc7" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Importing modules...</body>
                    </command>
                    <nestedSteps>
                        <item guid="b4c24a7a-706b-41db-87d2-209d9399f129" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>from ospf.ospf_2_01_verify_md5_authentication import *</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>Traceback (most recent call last):</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Error importing python module. Exiting execution. </message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="de59bc0c-1f5f-4f7d-8c17-3f3295ab4fe8" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Initializing variables...</body>
                    </command>
                    <nestedSteps>
                        <item guid="65ad083a-63c3-4082-aede-eefa5a046f03" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>md5_password = &quot;maule123&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="68717b86-53f9-4b10-8237-a6dfc68e5415" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>md5_key_id = 1</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="42ace539-ead4-4185-8268-69ec3d78dd29" action="command" session="SD-WAN">
                            <command>
                                <body>edge_id = &quot;[tbml(&apos;property&apos;, &apos;-name&apos;, &apos;SD-WAN&apos;, &apos;edgeId&apos;)]&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d6b24129-9563-4fd0-8b16-3aa90b01e368" action="command" session="SD-WAN">
                            <command>
                                <body>enterprise_id = &quot;[tbml(&apos;property&apos;, &apos;-name&apos;, &apos;SD-WAN&apos;, &apos;enterpriseId&apos;)]&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="69328e15-7eb0-4f99-a397-415d262f8db2" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>create_edge(edge_id=edge_id, enterprise_id=enterprise_id)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="89fe0ea8-6755-479d-9aad-7dfbd2b06e04" action="comment" useFieldsInCommand="false">
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="4b4831e7-99c5-401a-bbd3-3f2fd18b56f8" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Getting OSPF Neighbors from Edge. Expecting no OSPF Neighbors to be present.</body>
                    </command>
                    <nestedSteps>
                        <item guid="818f9141-b2cd-49b2-a12e-a6c838429aa0" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>get_ospf_neighbors_count()</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == 0</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>No OSPF Neighbors present.</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>[value] OSPF Neighbors. Expected 0 Neighbors before initiating test. Exiting execution.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                        <skip>true</skip>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == 0</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>No OSPF Neighbors present.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="RepeatStep">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.RepeatStepPropertyGroup" maxRepeatCount="3" delayBetweenRepeats="30.0"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <eventHandlers>
                                <item name="OnQueryExtractorInvalidQuery">
                                    <item actionId="DeclareExecutionIssue">
                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                            <message>{auto_message_wait}</message>
                                        </actionProperties>
                                    </item>
                                    <item actionId="RepeatStep">
                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.RepeatStepPropertyGroup"/>
                                    </item>
                                </item>
                                <item name="OnNoMatchesFound">
                                    <item actionId="DeclareExecutionIssue">
                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                            <message>{auto_message_wait}</message>
                                        </actionProperties>
                                    </item>
                                    <item actionId="RepeatStep">
                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.RepeatStepPropertyGroup"/>
                                    </item>
                                </item>
                            </eventHandlers>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="75218312-8e03-42f8-bb9d-90aa1aaeda3c" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Configuring Ixia Switch for IxNetwork...</body>
                    </command>
                    <nestedSteps>
                        <item guid="c4854746-526c-4ab5-a193-d47d5d3e1055" action="change_vlans" session="IXIA_SWITCH" useFieldsInCommand="false">
                            <command>
                                <body>-interface &quot;gi 0/7&quot; -vlan_id [tbml(&apos;property&apos;, &apos;-name&apos;, &apos;SD-WAN&apos;, &apos;vlan_id_global&apos;)]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="4dc106cd-44be-4130-850e-d96bc4702670" action="comment" useFieldsInCommand="false">
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="98ad6f45-f2ca-4f14-a37b-d6ebf57a8e5a" action="comment" skip="true" useFieldsInCommand="false">
                    <command>
                        <body>Scenario #1: MD5 Auth disabled on Edge. MD5 Auth disabled on IxNetwork. 1 OSPF Full Neighbor should show up.</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="d72f4d7d-ba81-451e-b5f2-5c3f54e7f0e0" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Disabling OSPF MD5 Auth on Edge.</body>
                    </command>
                    <nestedSteps>
                        <item guid="e2524d1e-9b02-472d-a009-8d8176fa1eab" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>disable_ospf_md5_auth()</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="69fbba85-d225-4658-a50c-8da1dadfa1d4" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Starting IxNetwork with MD5 Auth Disabled. Expecting 1 OSPF Full Neighbor.</body>
                    </command>
                    <nestedSteps>
                        <item guid="02e58b56-c484-4133-afb5-433b16981ad8" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>start_ix_network(enable_ospf_md5=False)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>Traceback (most recent call last):</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Failed to start Ix Network. Exiting execution. </message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString sub="false">[INFO] OSPF Full Nbrs equals to 1.</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>OSPF Full Nbrs equals to 1.</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>OSPF Full Nbrs does not equal to 1.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="5ad7c873-a87d-400b-bdfb-dc7ac0bf4ee3" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Getting OSPF Neighbors from Edge. Expecting 1 OSPF Neighbor to be present.</body>
                    </command>
                    <nestedSteps>
                        <item guid="ade23c1b-6c86-4683-a580-1507e8892222" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>get_ospf_neighbors_count()</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt;= 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>[value] OSPF Neighbors present.</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>[value] OSPF Neighbors. Expected more than 1 Neighbor with MD5 Authentication disabled. Exiting execution.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="63936969-0dcf-4760-a870-d1dc371ea963" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Stopping IxNetwork.</body>
                    </command>
                    <nestedSteps>
                        <item guid="f20fecd5-aa50-47de-b713-544e59ded231" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>stop_ix_network(disconnect_ports=False)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2fc11613-7b6c-4b9c-9f32-1dfdafc9b101" action="comment" useFieldsInCommand="false">
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="9e5c142c-ef01-4535-8136-9ea2511aa78e" action="comment" skip="true" useFieldsInCommand="false">
                    <command>
                        <body>Scenario #2: MD5 Auth enabled on Edge. MD5 Auth enabled with Correct Password on IxNetwork. 1 OSPF Full Neighbor should show up.</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="5f93017f-d4ef-4da9-9cb8-51a1b879e324" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Enabling MD5 Auth on Edge.</body>
                    </command>
                    <nestedSteps>
                        <item guid="c12552b3-c28c-4bb5-88cb-0a780a4bfd5f" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>enable_ospf_md5_auth(key_id=md5_key_id, password=md5_password)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="93c1de43-bfcc-48de-8e4b-26702a434e10" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Starting IxNetwork with MD5 Auth Enabled and Correct MD5 Password. Expecting 1 OSPF Full Neighbor.</body>
                    </command>
                    <nestedSteps>
                        <item guid="e5c7ccce-b3b0-4329-b424-1f2dcd519973" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>start_ix_network(enable_ospf_md5=True, key_id=md5_key_id, password=md5_password)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>Traceback (most recent call last):</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Failed to start Ix Network. Exiting execution. </message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString sub="false">[INFO] OSPF Full Nbrs equals to 1.</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>OSPF Full Nbrs equals to 1.</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>OSPF Full Nbrs does not equal to 1.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="a129b06b-00fa-4003-a3f1-57a02821c37b" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Getting OSPF Neighbors from Edge. Expecting 1 OSPF Neighbor to be present.</body>
                    </command>
                    <nestedSteps>
                        <item guid="c7a0fd9c-6918-40ec-919b-6b687f40e2a1" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>get_ospf_neighbors_count()</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt;= 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>[value] OSPF Neighbors present.</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>[value] OSPF Neighbors. Expected more than 1 Neighbor after correct MD5 Authentication. Exiting execution.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="38608b8b-bfcc-4662-aafb-c865318624c6" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Stopping IxNetwork.</body>
                    </command>
                    <nestedSteps>
                        <item guid="9dd6d9fe-a16a-4b96-b6ed-314f25ac36a3" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>stop_ix_network(disconnect_ports=False)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="c8cc6a5f-5ced-4394-8fe3-e1a9e90cfbee" action="comment" useFieldsInCommand="false">
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="7ea2eceb-47d6-4df5-aa68-b237a2256f0b" action="comment" skip="true" useFieldsInCommand="false">
                    <command>
                        <body>Scenario #3: MD5 Auth enabled on Edge. MD5 Auth enabled with Incorrect Password on IxNetwork. OSPF Full Neighbor should timeout.</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="9db5a7ba-b3d2-487d-a8c5-eac714d9f505" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Enabling MD5 Auth on Edge.</body>
                    </command>
                    <nestedSteps>
                        <item guid="ed4027fe-0465-47c8-9b14-c9218fffb33c" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>enable_ospf_md5_auth(key_id=md5_key_id, password=md5_password)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="f2f17fea-c04f-48e7-bec4-3db2c3504fd0" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Starting IxNetwork with MD5 Auth Enabled and Incorrect MD5 Password. Expecting OSPF Full Neighbor timeout</body>
                    </command>
                    <nestedSteps>
                        <item guid="7887744e-b423-452b-8fe1-76494a954d97" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>start_ix_network(enable_ospf_md5=True, key_id=md5_key_id, password=&apos;321eluam&apos;)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>Traceback (most recent call last):</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Failed to start Ix Network. Exiting execution. </message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>{&apos;error&apos;: &apos;OSPF Session Timeout&apos;}</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>OSPF Session Timedout</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>OSPF Session did not Timedout</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="f1d1f493-49bb-4bf1-a16c-4016980f686e" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Getting OSPF Neighbors from Edge. Expecting no OSPF Neighbors to be present.</body>
                    </command>
                    <nestedSteps>
                        <item guid="76a5fad2-cf73-41e5-b019-87d64016f125" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>get_ospf_neighbors_count()</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == 0</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                            <message>No OSPF Neighbors present.</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>[value] OSPF Neighbors. Expected 0 Neighbors after incorrect MD5 Authentication. Exiting execution.</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="17c4e257-79ce-44d5-bce9-d7bd8f3c0607" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Stopping IxNetwork.</body>
                    </command>
                    <nestedSteps>
                        <item guid="5eb1dc40-49f1-46bb-875e-970681f78a05" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>stop_ix_network()</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="acdfe78e-7843-4fe5-89a5-61484513faad" action="comment" useFieldsInCommand="false">
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2b5d1574-e191-4f0e-82b5-57b21728709c" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Disabling MD5 Auth on Edge.</body>
                    </command>
                    <nestedSteps>
                        <item guid="fd38dbc2-3cfc-48fb-aff8-21f8bb34a7d4" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>disable_ospf_md5_auth()</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="ccee894f-be72-45e6-bfd0-2ddec886c6aa" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Restore Edge settings</body>
                    </command>
                    <nestedSteps>
                        <item guid="a96f5967-9136-43ac-8069-411c18e238bb" action="command" session="SD-WAN" useFieldsInCommand="false">
                            <command>
                                <body>restore_settings()</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
        </item>
    </procedures>
</testCase>
