<?xml version="1.0"?>
<testCase version="8.1.3.0">
    <execution>
        <parameters version="8.1.3.0">
            <parameters escape="true">
                <parameters xmlns:pt="http://www.fnfr.com/schemas/parameterTree">
                    <primary_interface/>
                    <remote_host>208.57.21.183</remote_host>
                </parameters>
            </parameters>
        </parameters>
    </execution>
    <testbed>project://a_voip/topologies/Adtran/lab_basic_adtran.tbml</testbed>
    <procedures>
        <item name="main">
            <steps>
                <item guid="56f39033-83c4-4e2e-a1f6-e58d0a65db4a" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Call appropiate Adtran or Cisco procedure based on topology filename</body>
                    </command>
                    <nestedSteps>
                        <item guid="253a585e-5f9e-44d7-b531-3d8763fe6424" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>info testbedFile</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>adtran</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>$value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="CallProcedure">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                            <command>Adtran</command>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>cisco</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>$value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="CallProcedure">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                            <command>Cisco</command>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTestIfPassing">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Topology selected is non-Adtran nor non-Cisco</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
        </item>
        <item name="Adtran">
            <steps>
                <item guid="82216c21-248f-4bb4-998c-7e0d82ae963a" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Open CPE and Login</body>
                    </command>
                    <nestedSteps>
                        <item guid="a6113b74-0c00-4f30-afb7-18fc3cf7ce1f" action="open" session="CPE">
                            <command>
                                <body>device:CPE#ssh</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                <sessionProperties type="com.fnfr.svt.applications.ssh.documents.SSHProperties"/>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                        <item guid="1feae3d1-e3bb-4797-bb74-f8eba0478395" action="Login" session="CPE" useFieldsInCommand="false">
                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="a3a6a3c9-7e54-49ec-a33c-1669f94371d0" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Check for primary interface status</body>
                    </command>
                    <nestedSteps>
                        <item guid="a9f689ce-ab94-4979-9030-f635f2590453" action="GetIntStatusJ" session="CPE" useFieldsInCommand="false">
                            <command>
                                <body>-interface [param prim_int]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="5333966f-0b58-4229-8475-89112ee05c63" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Backup config using TFTP</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>----- Backup config using TFTP -----</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="0e65614d-e15d-4f83-98d5-08054a44fa2e" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Create backup_file string</body>
                            </command>
                            <nestedSteps>
                                <item guid="15114bdc-06e9-4938-96d5-1a803081254d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>set epoch [clock seconds]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="134943c0-5343-4c0a-8cec-e44672e40b8f" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>set backup_file [clock format $epoch -format CPE_%m%d%y_%H%M_backup.txt]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e9d6074f-564a-4807-a29e-626a3cc12aed" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Copy running config to a temp file (backup_file)</body>
                            </command>
                            <nestedSteps>
                                <item guid="22ca761b-11c3-4c4c-a7f4-cfd5c504a9cf" action="command" session="CPE">
                                    <command>
                                        <body>copy running-config $backup_file</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7d93ef5b-0b99-4c53-9514-8ef48e62592e" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Validate if backup_file exists</body>
                            </command>
                            <nestedSteps>
                                <item guid="e8989fe0-d569-4459-aea0-2bba81e5f561" action="command" session="CPE">
                                    <command>
                                        <body>dir flash</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="contains">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                        <searchString>$backup_file</searchString>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == 1</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>&quot;$backup_file&quot; made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>&quot;$backup_file&quot; did not made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Backup config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query sub="true">col2_by_key(&quot;$backup_file&quot;)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value &gt; 0</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>&quot;$backup_file&quot; has non-zero file size. File size is &quot;$value&quot;</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>&quot;$backup_file&quot; has zero file size.</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Backup config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c95bbf74-083c-41ec-ad46-08cab40450a0" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Copy Flash TFTP</body>
                            </command>
                            <nestedSteps>
                                <item guid="ed075e9e-bf53-4386-84fa-36a242e6d289" action="command" session="CPE" normalOffset="15.737" estimatedStepExecutionTime="0.223">
                                    <command>
                                        <body>copy flash tftp</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="4ca18136-7b61-46a8-b5b2-89cc6f4f85d8" action="command" session="CPE" normalOffset="18.081" estimatedStepExecutionTime="0.211">
                                    <command>
                                        <body>[param remote_host]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="49f3e3a2-b096-4a0d-a962-a4b6d308778b" action="command" session="CPE" normalOffset="28.781" estimatedStepExecutionTime="0.212">
                                    <command>
                                        <body>$backup_file</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="268eda39-fdf6-4cd1-ba0a-9f6d71b83592" action="command" session="CPE" normalOffset="32.372" estimatedStepExecutionTime="0.423" responseMap="project://d_Adtran_CPE/response_maps/copy_command.ffrm" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>$backup_file</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>Transfer()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>($value eq &quot;complete&quot;) &amp;&amp; ([query . Sent()] &gt; 0)</expression>
                                                        <actionOnMultiple>True if all true</actionOnMultiple>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>Copy flash tftp successful</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                    <message>----- Backup config using TFTP passed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>Copy flash tftp failed</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Backup config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="a28e7167-785d-4f09-a8bf-f09d61878262" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Restore config using TFTP</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>----- Restore config using TFTP -----</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="bd384aa0-088f-4676-822c-521aba4fdec1" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Create restore_file string</body>
                            </command>
                            <nestedSteps>
                                <item guid="264c333f-5dae-4676-bf33-fff52db426d2" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>set restore_file [clock format $epoch -format CPE_%m%d%y_%H%M_restore.txt]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="9d1e7e5d-f307-4686-9d10-0247494f5d92" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Copy TFTP Flash</body>
                            </command>
                            <nestedSteps>
                                <item guid="af4e6dc1-d2c2-427d-82f4-2e80e856ac37" action="command" session="CPE" normalOffset="340.911" estimatedStepExecutionTime="0.22">
                                    <command>
                                        <body>copy tftp flash</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="4663c7b0-5e7a-4796-bb45-a3c5286e7f4b" action="command" session="CPE" normalOffset="8.746" estimatedStepExecutionTime="0.212">
                                    <command>
                                        <body>[param remote_host]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="2947912d-84c7-40c5-91ef-348522e72cff" action="command" session="CPE" normalOffset="26.821" estimatedStepExecutionTime="0.212">
                                    <command>
                                        <body>$backup_file</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="abdc745b-cb96-4c10-8908-05ff37e2d168" action="command" session="CPE" normalOffset="29.973" estimatedStepExecutionTime="0.433" responseMap="project://d_Adtran_CPE/response_maps/copy_command.ffrm" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>$restore_file</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="none">
                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>([query . Transfer()] == &quot;complete&quot; ) &amp;&amp; ([query . Received() ] &gt; 0)</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>Copy tftp flash successful</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>Copy tftp flash failed</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file -restore_filename $restore_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Restore config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c80baaae-282b-4ac6-8f2d-9a21b33b192e" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Validate if restore_file exists</body>
                            </command>
                            <nestedSteps>
                                <item guid="53729186-01ef-4aec-9af6-cd6b51cb90a3" action="command" session="CPE" normalOffset="6.913" estimatedStepExecutionTime="0.509">
                                    <command>
                                        <body>dir flash</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="contains">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                        <searchString>$restore_file</searchString>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == 1</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>&quot;$restore_file&quot; made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>$restore_file did not made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file -restore_filename $restore_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Restore config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query sub="true">col2_by_key(&quot;$backup_file&quot;)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == &quot;[query . col2_by_key(&quot;$restore_file&quot;)]&quot;</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>&quot;$restore_file&quot; ([query . col2_by_key(&quot;$restore_file&quot;)]) has same byte size as &quot;$backup_file&quot; ($value)</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                    <message>----- Restore config using TFTP passed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>$backup_file and $restore_file have different file sizes</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Restore config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                        <storeResponseAt>flash_response</storeResponseAt>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="8c436109-b3e2-4549-a206-b2a0ce17998f" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Cleanup</body>
                    </command>
                    <nestedSteps>
                        <item guid="a7442c99-f803-4ce5-9129-0267f98a04a2" action="call" useFieldsInCommand="false">
                            <command>
                                <body>cleanup -backup_filename $backup_file -restore_filename $restore_file</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
        </item>
        <item name="Cisco">
            <steps>
                <item guid="5aada3d6-6ac4-4f23-8121-17f0b69ca851" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Open CPE and Login</body>
                    </command>
                    <nestedSteps>
                        <item guid="8931273c-c938-4e13-ac43-feb2cc7be83a" action="open" session="CPE">
                            <command>
                                <body>device:CPE#ssh</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                <sessionProperties type="com.fnfr.svt.applications.ssh.documents.SSHProperties"/>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="59805b31-1549-4d19-a487-0440769c315e" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Check for primary interface status</body>
                    </command>
                    <nestedSteps>
                        <item guid="25e2d695-6217-4ae7-8b53-e1dc6ebd88ad" action="GetIntStatus" session="CPE" useFieldsInCommand="false">
                            <command>
                                <body>-interface [param prim_int]</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>mapped/Json/int_status</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>$value eq &quot;up&quot;</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                            <message>Primary interface [param prim_int] is &quot;up&quot;</message>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Primary interface [param prim_int] is &quot;$value&quot;</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="73e32fe3-0e10-4ac3-9788-8d7d3f28352a" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Backup config using TFTP</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>----- Backup config using TFTP -----</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="dc12fb25-982a-44fe-ba33-ed7fee985ddf" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Copy running config to a temp file (backup_file)</body>
                            </command>
                            <nestedSteps>
                                <item guid="eed75008-cfbf-4d71-90c2-aa6a26ab3c4c" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Create backup_file string</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="35f8fd00-efa4-4a26-9bb7-c03add6c2375" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>set systemTime [clock seconds]</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="5450d6af-3660-4b90-abf5-4e37e4fc28ec" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>set backup_file [clock format $systemTime -format CPE_%m%d%y_%H%M_backup.txt]</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="15b1c498-487f-4b45-892f-f177bd4940fa" action="command" session="CPE">
                                    <command>
                                        <body>copy running-config $backup_file</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                                <item guid="a9e61275-e7d8-42b8-a718-0739c17879fd" action="command" session="CPE">
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>bytes_copied_in()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value &gt; 0</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>Bytes copied are less than or equal to 0</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Backup config using TFTP failed-----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ae4eb29f-4181-419a-abcf-1eb123e115ba" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Validate if backup_file exists</body>
                            </command>
                            <nestedSteps>
                                <item guid="ac548f76-d88c-444e-9ade-c1b1fb479021" action="command" session="CPE">
                                    <command>
                                        <body>dir flash:</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="contains">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                        <searchString>$backup_file</searchString>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == 1</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>&quot;$backup_file&quot; made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>&quot;$backup_file&quot; did not made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Backup config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="672f02f4-4651-483c-b566-bf3a1c1a2950" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Copy Flash TFTP</body>
                            </command>
                            <nestedSteps>
                                <item guid="6899a6f8-c33b-4a64-b348-5c4e36c6729f" action="command" session="CPE" normalOffset="15.737" estimatedStepExecutionTime="0.223">
                                    <command>
                                        <body>copy flash tftp</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="autoPrompt1">
                                                    <Content>Address of remote host?</Content>
                                                </item>
                                            </stepPrompts>
                                        </promptProperties>
                                        <completionProperties expectedIdleTime="0.642" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                                <item guid="a5258d17-29b1-4d61-9826-d802f117e5ff" action="command" session="CPE" normalOffset="28.781" estimatedStepExecutionTime="0.212">
                                    <command>
                                        <body>$backup_file</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="autoPrompt1">
                                                    <Content>Destination filename?</Content>
                                                </item>
                                            </stepPrompts>
                                        </promptProperties>
                                        <completionProperties expectedIdleTime="5.433" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                                <item guid="7cf09e71-3f6c-49e7-8903-3881b0aa8169" action="command" session="CPE" normalOffset="18.081" estimatedStepExecutionTime="0.211">
                                    <command>
                                        <body>[param remote_host]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <completionProperties>
                                            <completeWhen inherit="false">AUTO_OR_IDLE</completeWhen>
                                        </completionProperties>
                                    </applicationProperties>
                                </item>
                                <item guid="7c7aeadb-4b6c-4710-b7cd-6b34cdfe0135" action="command" session="CPE" normalOffset="32.372" estimatedStepExecutionTime="0.423" responseMap="project://d_Adtran_CPE/copy_command.ffrm">
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>bytes_copied_in()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value &gt; 0</expression>
                                                        <actionOnMultiple>True if all true</actionOnMultiple>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>Copy flash tftp successful</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                    <message>----- Backup config using TFTP passed-----</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>Copy flash tftp failed</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Backup config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <completionProperties expectedIdleTime="2.745" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="d6b1404a-9ef7-448c-95c2-1d59a2841793" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Restore config using TFTP</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>----- Restore config using TFTP -----</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="25d9d24d-0eb8-45d0-89ec-ff5d2a6d9a12" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Create restore_file string</body>
                            </command>
                            <nestedSteps>
                                <item guid="5dbbe18f-f448-43a9-904d-9d7688473a01" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>set restore_file [clock format $systemTime -format CPE_%m%d%y_%H%M_restore.txt]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="24dd8e07-d0f9-47c4-b4af-a8004904f5f9" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Copy TFTP Flash</body>
                            </command>
                            <nestedSteps>
                                <item guid="0061864c-a489-4b36-9739-32f61400fbfc" action="command" session="CPE" normalOffset="340.911" estimatedStepExecutionTime="0.22">
                                    <command>
                                        <body>copy tftp flash</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="autoPrompt1">
                                                    <Content>Address of remote host?</Content>
                                                </item>
                                            </stepPrompts>
                                        </promptProperties>
                                        <completionProperties expectedIdleTime="1.405" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                                <item guid="c0264f41-8ac3-452f-8040-c2abb6dcc950" action="command" session="CPE" normalOffset="8.746" estimatedStepExecutionTime="0.212">
                                    <command>
                                        <body>[param remote_host]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="autoPrompt1">
                                                    <Content>Source filename?</Content>
                                                </item>
                                            </stepPrompts>
                                        </promptProperties>
                                        <completionProperties expectedIdleTime="1.24" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                                <item guid="a4685d43-17fc-41bf-ab54-b474e0fa3421" action="command" session="CPE" normalOffset="26.821" estimatedStepExecutionTime="0.212">
                                    <command>
                                        <body>$backup_file</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <promptProperties>
                                            <stepPrompts>
                                                <item name="autoPrompt1">
                                                    <Content sub="true">Destination filename? \\[$backup_file\\]</Content>
                                                </item>
                                            </stepPrompts>
                                        </promptProperties>
                                        <completionProperties expectedIdleTime="6.194" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                                <item guid="4f059a72-3f94-42eb-a077-7546412c7f7d" action="command" session="CPE" normalOffset="29.973" estimatedStepExecutionTime="0.433" responseMap="project://d_Adtran_CPE/copy_command.ffrm">
                                    <command>
                                        <body>$restore_file</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>bytes_copied_in()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value &gt; 0</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>Copy tftp flash successful</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>Copy tftp flash failed</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Restore config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file -restore_filename $restore_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <completionProperties expectedIdleTime="4.972" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6a01dee9-37cf-4ca0-935b-fb4f1c0efb87" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Validate restore_file exists &amp; save it&apos;s byte size</body>
                            </command>
                            <nestedSteps>
                                <item guid="22e93c72-d5b0-4608-84b4-f82bf4d721f5" action="command" session="CPE" normalOffset="6.913" estimatedStepExecutionTime="0.509" responseMap="project://d_Cisco_CPE_ssh/response_maps/dir_command.ffrm" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>dir</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="contains">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                        <searchString>$restore_file</searchString>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == 1</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>$restore_file did not made it to flash</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Restore config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file -restore_filename $restore_file</command>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query sub="true">Bytes_by_Filename(&quot;$restore_file&quot;)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>restore_file_bytes</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties">
                                        <completionProperties expectedIdleTime="0.616" expectedIdleTime.inherit="false"/>
                                    </applicationProperties>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ed81444b-4c22-42b6-9c98-37057d08d830" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Check running-config with restore file</body>
                            </command>
                            <nestedSteps>
                                <item guid="0259152e-b5d7-439f-8e28-f8e9000f79e0" action="command" session="CPE" responseMap="project://d_Cisco_CPE_ssh/response_maps/show_running-config.ffrm" useResponseMapLibraryApplicability="false">
                                    <command>
                                        <body>show running-config</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>Current_configuration()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>$value == $restore_file_bytes</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                    <message>Restore file byte size (&quot;$restore_file_bytes&quot;) matches with running-config byte size (&quot;$value&quot;)</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                    <message>----- Restore config using TFTP passed-----</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                    <message>Restore file byte size does not match with running-config byte size</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>----- Restore config using TFTP failed -----</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="CallProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.CallProcedurePropertyGroup">
                                                                    <command>cleanup -backup_filename $backup_file -restore_filename $restore_file</command>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                    <useResponseMapLibraryFromSession>false</useResponseMapLibraryFromSession>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="e86dc89e-71c6-4374-b4d6-8b35144717cc" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Cleanup</body>
                    </command>
                    <nestedSteps>
                        <item guid="45dae85b-da73-4e46-9c94-f7479addda3c" action="call" useFieldsInCommand="false">
                            <command>
                                <body>cleanup -backup_filename $backup_file -restore_filename $restore_file</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
        </item>
        <item name="cleanup" isPublic="true" defaultSessionProfile="project://d_Cisco_CPE_ssh/session_profiles/Cisco_CPE_ssh_base.ffsp" isVBlock="true">
            <steps>
                <item guid="83a54e82-98b4-4fe8-98d1-0c30d4c7c381" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Erase backup and restore temp files</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="none">
                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>----- Cleaning Backup &amp; Restore Files -----</message>
                                        <tag sub="false" defaultValue=""/>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <nestedSteps>
                        <item guid="e2b48531-24a7-4a55-b82b-df51af3b34a1" action="if" useFieldsInCommand="false">
                            <command>
                                <body>$backup_filename != &quot;&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="2bf65f56-241b-443a-934c-f006b78c011a" action="then" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="6fcd46bd-2703-4834-93e4-cfd5af3f961f" action="EraseFile" session="CPE" useFieldsInCommand="false">
                                            <command>
                                                <body>-filename $backup_filename</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/success</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>$value == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                            <message>&quot;$backup_filename&quot; successfully deleted</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                            <message>Error deleting &quot;$backup_filename&quot;</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="821348a0-9f82-4b84-9ef4-43785a444205" action="if" useFieldsInCommand="false">
                            <command>
                                <body>$restore_filename != &quot;&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="12d77bf4-31ea-48d2-8f88-d58d8bf3f543" action="then" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="b9476fdd-9f33-4e83-8844-ecbb9298cbe6" action="EraseFile" session="CPE" useFieldsInCommand="false">
                                            <command>
                                                <body>-filename $restore_filename</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/success</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>$value == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                            <message>&quot;$restore_filename&quot; successfully deleted</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                            <message>Error deleting &quot;$restore_filename&quot;</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.editors.terminal.documents.StepDefaultProperties"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <multilineDescription>Erase backup file and restore file</multilineDescription>
            <arguments>
                <item name="backup_filename">
                    <description>String of backup file</description>
                    <isMandatory>true</isMandatory>
                </item>
                <item name="restore_filename">
                    <description>String of restore filename</description>
                </item>
            </arguments>
        </item>
    </procedures>
</testCase>
